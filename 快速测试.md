# 快速测试 API 接口

## 方法1：使用 PowerShell（推荐）

### 在 PowerShell 中直接运行：

```powershell
# 测试接口
Invoke-WebRequest -Uri http://localhost:5000/api/test -Method GET

# 或者使用别名（更短）
iwr http://localhost:5000/api/test

# 只显示内容
(iwr http://localhost:5000/api/test).Content

# 格式化 JSON 输出
(iwr http://localhost:5000/api/test).Content | ConvertFrom-Json | ConvertTo-Json
```

### 使用测试脚本：

```powershell
# 运行 PowerShell 脚本
.\test_api_simple.ps1

# 或者运行批处理脚本
.\test_api_simple.bat
```

## 方法2：使用 curl（如果已安装）

```powershell
curl http://localhost:5000/api/test
```

## 方法3：在浏览器中访问

直接打开浏览器，访问：
```
http://localhost:5000/api/test
```

## 方法4：使用 Python 测试

```python
import requests

response = requests.get('http://localhost:5000/api/test')
print(response.json())
```

## 常见错误解决

### 错误1：`找不到接受实际参数"iwr"的位置形式参数`

**原因**：复制命令时包含了 PowerShell 提示符 `PS C:\Users\...>`

**解决**：只复制命令本身，不要包含提示符

**正确**：
```powershell
iwr http://localhost:5000/api/test
```

**错误**：
```powershell
PS C:\Users\langzi2> iwr http://localhost:5000/api/test
```

### 错误2：`无法连接到远程服务器`

**原因**：Flask 服务未启动

**解决**：
1. 打开新的终端窗口
2. 进入项目目录：`cd D:\BaiduNetdiskDownload\houduan`
3. 启动服务：`python app.py`
4. 等待看到 "服务启动中..." 的提示

### 错误3：`此命令不能识别为 cmdlet`

**原因**：PowerShell 版本太旧或命令拼写错误

**解决**：
- 使用完整命令：`Invoke-WebRequest` 而不是 `iwr`
- 或者使用批处理脚本：`.\test_api_simple.bat`

## 测试接口列表

- **测试接口**：`GET http://localhost:5000/api/test`
  - 快速响应，无需数据库
  - 返回服务状态和时间戳

- **健康检查**：`GET http://localhost:5000/api/health`
  - 包含数据库连接状态
  - 包含文件目录检查

- **统计接口**：`GET http://localhost:5000/api/stats`
  - 返回题目和答案版本数量
  - 需要数据库查询

## 完整测试流程

1. **启动 Flask 服务**（终端1）：
   ```powershell
   cd D:\BaiduNetdiskDownload\houduan
   python app.py
   ```

2. **测试本地服务**（终端2）：
   ```powershell
   # 方法1：使用脚本
   .\test_api_simple.ps1
   
   # 方法2：直接命令
   iwr http://localhost:5000/api/test
   
   # 方法3：浏览器
   # 打开 http://localhost:5000/api/test
   ```

3. **启动内网穿透**（终端3）：
   ```powershell
   .\start_tunnel_localtunnel.bat
   # 或
   npx localtunnel --port 5000
   ```

4. **测试公网访问**（终端4 或浏览器）：
   ```powershell
   # 使用脚本（替换为实际的公网URL）
   .\test_tunnel_public.bat https://xxxx.loca.lt
   
   # 或浏览器访问
   # https://xxxx.loca.lt/api/test
   ```


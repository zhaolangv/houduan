# 最快OCR方案 - 几秒钟提取一张

## 当前状态

- **当前速度**：13-21秒/张（不稳定）
- **目标速度**：几秒钟/张
- **成功率**：66-100%（不稳定）

## 问题分析

要达到几秒钟的目标，需要：

1. **AI OCR（火山引擎vision）**：当前13-21秒，受限于API响应时间
2. **PaddleOCR**：19秒，但识别质量差（只识别到字母）
3. **需要更快的方案**

## 解决方案

### 方案1：使用更快的OCR API（推荐）

**百度OCR API**：
- 速度：2-5秒/张
- 准确率：高
- 需要：API Key（可能有免费额度）

**腾讯OCR API**：
- 速度：2-5秒/张
- 准确率：高
- 需要：API Key（可能有免费额度）

**阿里云OCR API**：
- 速度：2-5秒/张
- 准确率：高
- 需要：API Key（可能有免费额度）

### 方案2：优化PaddleOCR识别质量

**问题**：PaddleOCR只识别到字母，没有中文

**可能原因**：
1. 图片质量问题
2. OCR参数需要调整
3. 需要图片预处理（裁剪、增强）

**优化方向**：
1. 图片预处理（裁剪题目区域）
2. 调整PaddleOCR参数
3. 使用更精确的OCR模型

### 方案3：混合方案优化

**当前方案**：
- 快速OCR（19秒）→ 规则过滤 → AI OCR（13秒）

**优化方向**：
- 如果快速OCR识别到足够文字（即使质量不高），也尝试使用
- 降低规则过滤的置信度阈值
- 部分成功也返回（有题干或选项即可）

### 方案4：并行处理优化

**批量处理**：
- 5张图片并行：约4-5秒/张
- **建议**：使用批量接口，而不是单张处理

## 推荐方案

### 短期方案（最快实现）

1. **使用批量接口**：`POST /api/questions/analyze/batch`
   - 5张图片并行：约4-5秒/张
   - 已实现，可直接使用

2. **降低快速OCR阈值**：
   - 降低置信度要求（从0.7降到0.5）
   - 即使识别质量不高，也尝试使用

### 长期方案（最佳性能）

1. **集成百度OCR API**：
   - 速度：2-5秒/张
   - 准确率：高
   - 需要申请API Key

2. **优化PaddleOCR**：
   - 图片预处理
   - 参数优化
   - 如果能识别到中文，19秒就能完成

## 实施建议

### 立即实施（最快）

**使用批量接口**：
```python
# 5张图片并行处理
POST /api/questions/analyze/batch
{
  "questions": [
    {"image": "base64_1", ...},
    {"image": "base64_2", ...},
    {"image": "base64_3", ...},
    {"image": "base64_4", ...},
    {"image": "base64_5", ...}
  ]
}
# 结果：约4-5秒/张
```

### 中期优化

1. 降低快速OCR置信度阈值（已实现）
2. 优化图片压缩参数（已优化）
3. 优化提示词（已优化）

### 长期优化

1. 集成百度OCR API（需要申请）
2. 优化PaddleOCR识别质量（需要调试）

## 当前最佳方案

**使用批量接口并行处理**：
- 单张：13秒
- 5张并行：约4-5秒/张
- **这是目前能达到几秒钟的唯一方案**


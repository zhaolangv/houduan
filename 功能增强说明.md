# åŠŸèƒ½å¢å¼ºè¯´æ˜

## âœ… å·²å®Œæˆçš„åŠŸèƒ½

### 1. é¢˜ç›®åˆ†ç±»å’Œåˆæ­¥ç­”æ¡ˆæå–

åœ¨æ‰¹é‡æå–æ¥å£ä¸­ï¼Œå·²æ·»åŠ ä»¥ä¸‹åŠŸèƒ½ï¼š

- âœ… **é¢˜ç›®åˆ†ç±»**ï¼šè‡ªåŠ¨åˆ¤æ–­é¢˜ç›®ç±»å‹
  - è¡Œæµ‹ï¼šè¨€è¯­ç†è§£ã€æ•°é‡å…³ç³»ã€åˆ¤æ–­æ¨ç†ã€èµ„æ–™åˆ†æã€å¸¸è¯†åˆ¤æ–­
  - ç”³è®º
- âœ… **åˆæ­¥ç­”æ¡ˆ**ï¼šAIè‡ªåŠ¨ç»™å‡ºåˆæ­¥ç­”æ¡ˆï¼ˆA/B/C/Dï¼‰
- âœ… **ç­”æ¡ˆç†ç”±**ï¼šæä¾›ç®€è¦çš„ç†ç”±è¯´æ˜

#### æ¥å£è¿”å›æ ¼å¼

```json
{
  "success": true,
  "results": [
    {
      "success": true,
      "question_text": "å®Œæ•´çš„é¢˜å¹²å†…å®¹",
      "options": ["A. é€‰é¡¹A", "B. é€‰é¡¹B", "C. é€‰é¡¹C", "D. é€‰é¡¹D"],
      "question_type": "è¡Œæµ‹-è¨€è¯­ç†è§£",
      "preliminary_answer": "B",
      "answer_reason": "æ ¹æ®ä¸Šä¸‹æ–‡è¯­å¢ƒï¼Œé€‰é¡¹Bæœ€ç¬¦åˆæ–‡æ„...",
      "raw_text": "OCRåŸå§‹æ–‡æœ¬",
      "ocr_time": 6.5,
      "ai_time": 7.2,
      "total_time": 13.7,
      "cost": 0.000117
    }
  ]
}
```

---

### 2. æ¥å£æµ‹è¯•è„šæœ¬

å·²åˆ›å»ºå®Œæ•´çš„æµ‹è¯•è„šæœ¬ `test_api_all.py`ï¼Œå¯ä»¥æ¨¡æ‹Ÿå‰ç«¯è¯·æ±‚æµ‹è¯•æ‰€æœ‰æ¥å£ï¼š

#### æµ‹è¯•çš„æ¥å£

1. âœ… **å¥åº·æ£€æŸ¥**: `GET /api/health`
2. âœ… **å›¾ç‰‡ä¸Šä¼ **: `POST /api/upload`
3. âœ… **é¢˜ç›®åˆ†æ**: `POST /api/questions/analyze`
4. âœ… **æ‰¹é‡æå–**ï¼ˆæ–‡ä»¶ä¸Šä¼ ï¼‰: `POST /api/questions/extract/batch`
5. âœ… **æ‰¹é‡æå–**ï¼ˆJSONæ ¼å¼ï¼‰: `POST /api/questions/extract/batch`
6. âœ… **é¢˜ç›®è¯¦æƒ…**: `GET /api/questions/{id}/detail`
7. âœ… **æ‰¹é‡åˆ†æ**: `POST /api/questions/analyze/batch`

---

## ğŸ“ ä½¿ç”¨æ–¹æ³•

### è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
# ç¡®ä¿æœåŠ¡å·²å¯åŠ¨
python app.py

# åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œæµ‹è¯•
python test_api_all.py
```

### æ‰¹é‡æå–æ¥å£è°ƒç”¨ç¤ºä¾‹

#### æ–¹å¼1ï¼šæ–‡ä»¶ä¸Šä¼ ï¼ˆæ¨èï¼‰

```python
import requests

image_files = ['image1.jpg', 'image2.jpg']
files = []
for img_path in image_files:
    with open(img_path, 'rb') as f:
        files.append(('images[]', (os.path.basename(img_path), f.read(), 'image/jpeg')))

data = {'max_workers': '10'}

response = requests.post(
    'http://localhost:5000/api/questions/extract/batch',
    files=files,
    data=data,
    timeout=300
)

result = response.json()
```

#### æ–¹å¼2ï¼šJSONæ ¼å¼ï¼ˆbase64ï¼‰

```python
import requests
import base64

images_data = []
for img_path in image_files:
    with open(img_path, 'rb') as f:
        base64_data = base64.b64encode(f.read()).decode('utf-8')
        images_data.append({
            'filename': os.path.basename(img_path),
            'data': f"data:image/jpeg;base64,{base64_data}"
        })

payload = {
    'images': images_data,
    'max_workers': 10
}

response = requests.post(
    'http://localhost:5000/api/questions/extract/batch',
    json=payload,
    timeout=300
)
```

---

## ğŸ¯ è¿”å›æ•°æ®è¯´æ˜

### æ‰¹é‡æå–æ¥å£è¿”å›

```json
{
  "success": true,
  "results": [
    {
      "success": true,
      "question_text": "å®Œæ•´çš„é¢˜å¹²å†…å®¹",
      "options": ["A. é€‰é¡¹A", "B. é€‰é¡¹B", "C. é€‰é¡¹C", "D. é€‰é¡¹D"],
      "question_type": "è¡Œæµ‹-è¨€è¯­ç†è§£",
      "preliminary_answer": "B",
      "answer_reason": "ç®€è¦çš„ç†ç”±è¯´æ˜",
      "raw_text": "OCRåŸå§‹æ–‡æœ¬",
      "ocr_time": 6.5,
      "ai_time": 7.2,
      "total_time": 13.7,
      "input_tokens": 345,
      "output_tokens": 197,
      "total_tokens": 542,
      "cost": 0.000117
    }
  ],
  "statistics": {
    "total": 50,
    "success_count": 48,
    "failed_count": 2,
    "total_time": 150.5,
    "avg_time_per_question": 3.14,
    "total_cost": 0.005616
  }
}
```

### å­—æ®µè¯´æ˜

- `question_text`: å®Œæ•´çš„é¢˜å¹²å†…å®¹
- `options`: é€‰é¡¹æ•°ç»„ï¼ˆæ ¼å¼ï¼š["A. é€‰é¡¹A", "B. é€‰é¡¹B", ...]ï¼‰
- `question_type`: é¢˜ç›®ç±»å‹ï¼ˆæ–°å¢ï¼‰
  - æ ¼å¼ï¼š`"è¡Œæµ‹-è¨€è¯­ç†è§£"`ã€`"è¡Œæµ‹-æ•°é‡å…³ç³»"`ã€`"ç”³è®º"` ç­‰
- `preliminary_answer`: åˆæ­¥ç­”æ¡ˆï¼ˆæ–°å¢ï¼‰
  - æ ¼å¼ï¼š`"A"`ã€`"B"`ã€`"C"`ã€`"D"`
- `answer_reason`: ç­”æ¡ˆç†ç”±ï¼ˆæ–°å¢ï¼‰
  - ç®€è¦è¯´æ˜ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªç­”æ¡ˆ
- `raw_text`: OCRåŸå§‹è¯†åˆ«æ–‡æœ¬
- `ocr_time`: OCRè¯†åˆ«è€—æ—¶ï¼ˆç§’ï¼‰
- `ai_time`: AIå¤„ç†è€—æ—¶ï¼ˆç§’ï¼‰
- `total_time`: æ€»è€—æ—¶ï¼ˆç§’ï¼‰
- `cost`: æœ¬æ¬¡å¤„ç†è´¹ç”¨ï¼ˆå…ƒï¼‰

---

## ğŸ”§ é…ç½®è¯´æ˜

### é¢˜ç›®åˆ†ç±»ç±»å‹

ç³»ç»Ÿæ”¯æŒä»¥ä¸‹é¢˜ç›®ç±»å‹ï¼š

- **è¡Œæµ‹**
  - è¡Œæµ‹-è¨€è¯­ç†è§£
  - è¡Œæµ‹-æ•°é‡å…³ç³»
  - è¡Œæµ‹-åˆ¤æ–­æ¨ç†
  - è¡Œæµ‹-èµ„æ–™åˆ†æ
  - è¡Œæµ‹-å¸¸è¯†åˆ¤æ–­
- **ç”³è®º**

### AIæç¤ºè¯

ç³»ç»Ÿä½¿ç”¨ä¼˜åŒ–çš„æç¤ºè¯ï¼Œè¦æ±‚AIï¼š
1. æå–å®Œæ•´çš„é¢˜ç›®å†…å®¹å’Œé€‰é¡¹
2. åˆ¤æ–­é¢˜ç›®ç±»å‹
3. ç»™å‡ºåˆæ­¥ç­”æ¡ˆå’Œç†ç”±

---

## ğŸ“Š æ€§èƒ½è¯´æ˜

### å¤„ç†æ—¶é—´

- **OCRæ—¶é—´**ï¼šå¹³å‡ 6-13ç§’/å¼ 
- **AIå¤„ç†æ—¶é—´**ï¼šå¹³å‡ 7-14ç§’/å¼ ï¼ˆåŒ…å«åˆ†ç±»å’Œåˆæ­¥ç­”æ¡ˆï¼‰
- **å•é¢˜æ€»æ—¶é—´**ï¼šçº¦ 13-27ç§’/å¼ 

### è´¹ç”¨

- **å•æ¬¡è´¹ç”¨**ï¼šçº¦ Â¥0.000117/æ¬¡ï¼ˆåŒ…å«åˆ†ç±»å’Œåˆæ­¥ç­”æ¡ˆï¼‰
- **50é“é¢˜è´¹ç”¨**ï¼šçº¦ Â¥0.00585ï¼ˆçº¦6åˆ†é’±ï¼‰

### å¹¶å‘å¤„ç†

- **å¹¶å‘10**ï¼š50é¢˜çº¦2-3åˆ†é’Ÿ
- **å¹¶å‘20**ï¼š50é¢˜çº¦1-2åˆ†é’Ÿ

---

## âœ… æµ‹è¯•æ£€æŸ¥æ¸…å•

è¿è¡Œæµ‹è¯•è„šæœ¬å‰ï¼Œè¯·ç¡®ä¿ï¼š

- [ ] FlaskæœåŠ¡å·²å¯åŠ¨ï¼ˆ`python app.py`ï¼‰
- [ ] æœåŠ¡è¿è¡Œåœ¨ `http://localhost:5000`
- [ ] æµ‹è¯•å›¾ç‰‡ç›®å½•å­˜åœ¨ï¼š`uploads/ceshi`
- [ ] DeepSeek API Keyå·²é…ç½®ï¼ˆ`.env`æ–‡ä»¶ï¼‰
- [ ] PaddleOCRå·²å®‰è£…

---

## ğŸš€ ä¸‹ä¸€æ­¥

å¯ä»¥ç»§ç»­ä¼˜åŒ–ï¼š

1. æ›´ç²¾ç¡®çš„é¢˜ç›®åˆ†ç±»
2. æ›´è¯¦ç»†çš„ç­”æ¡ˆç†ç”±
3. æ”¯æŒæ›´å¤šé¢˜ç›®ç±»å‹
4. ä¼˜åŒ–å¤„ç†é€Ÿåº¦

---

## ğŸ“ é—®é¢˜åé¦ˆ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š

1. æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨
2. OCRæœåŠ¡æ˜¯å¦å¯ç”¨
3. DeepSeek API Keyæ˜¯å¦æ­£ç¡®
4. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
5. æµ‹è¯•å›¾ç‰‡æ˜¯å¦å­˜åœ¨

---

**æ‰€æœ‰åŠŸèƒ½å·²å®Œæˆå¹¶æµ‹è¯•é€šè¿‡ï¼** ğŸ‰

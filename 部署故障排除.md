# éƒ¨ç½²æ•…éšœæŽ’é™¤æŒ‡å—

## ðŸ”§ å¸¸è§éƒ¨ç½²é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

### é”™è¯¯1: torchç‰ˆæœ¬ä¸å¯ç”¨

**é”™è¯¯ä¿¡æ¯**:
```
ERROR: Could not find a version that satisfies the requirement torch==2.1.0
ERROR: No matching distribution found for torch==2.1.0
```

**åŽŸå› **: 
- PyPIä¸Šå·²ä¸å†æä¾›æ—§ç‰ˆæœ¬çš„torch
- å½“å‰å¯ç”¨çš„æœ€ä½Žç‰ˆæœ¬æ˜¯ 2.2.0

**è§£å†³æ–¹æ¡ˆ**:
å·²æ›´æ–° `requirements.txt`ï¼Œä½¿ç”¨æ›´çµæ´»çš„ç‰ˆæœ¬çº¦æŸï¼š
```txt
torch>=2.2.0,<3.0.0
torchvision>=0.17.0,<1.0.0
numpy>=1.24.0,<2.0.0
```

**éªŒè¯**:
```bash
# æœ¬åœ°æµ‹è¯•å®‰è£…
pip install -r requirements.txt
```

---

### é”™è¯¯2: ä¾èµ–åŒ…å®‰è£…å¤±è´¥

**å¯èƒ½åŽŸå› **:
1. Pythonç‰ˆæœ¬ä¸å…¼å®¹
2. ç³»ç»Ÿä¾èµ–ç¼ºå¤±
3. ç½‘ç»œé—®é¢˜

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥Pythonç‰ˆæœ¬**
   ```bash
   python --version
   # å»ºè®®ä½¿ç”¨ Python 3.10 æˆ– 3.11
   ```

2. **ä½¿ç”¨æ›´çµæ´»çš„ç‰ˆæœ¬çº¦æŸ**
   - å°† `==` æ”¹ä¸º `>=` å…è®¸å®‰è£…å…¼å®¹ç‰ˆæœ¬
   - ä¾‹å¦‚ï¼š`flask>=3.0.0` è€Œä¸æ˜¯ `flask==3.0.0`

3. **åˆ†æ‰¹å®‰è£…ä¾èµ–**
   ```bash
   # å…ˆå®‰è£…æ ¸å¿ƒä¾èµ–
   pip install flask flask-sqlalchemy psycopg2-binary python-dotenv
   
   # å†å®‰è£…å¯é€‰ä¾èµ–
   pip install sentence-transformers torch torchvision
   ```

---

### é”™è¯¯3: å†…å­˜ä¸è¶³

**é”™è¯¯ä¿¡æ¯**:
```
Killed
```

**åŽŸå› **: 
- torchå’Œsentence-transformerséœ€è¦å¤§é‡å†…å­˜ç¼–è¯‘
- Railwayå…è´¹é¢åº¦æœ‰é™

**è§£å†³æ–¹æ¡ˆ**:

1. **ä¼˜åŒ–requirements.txt**ï¼ˆå¦‚æžœä¸éœ€è¦embeddingåŠŸèƒ½ï¼‰
   ```txt
   # æ³¨é‡ŠæŽ‰ä¸éœ€è¦çš„å¤§åŒ…
   # sentence-transformers==2.2.2
   # torch>=2.2.0,<3.0.0
   # torchvision>=0.17.0,<1.0.0
   ```

2. **ä½¿ç”¨é¢„ç¼–è¯‘çš„wheelåŒ…**
   - Railwayä¼šè‡ªåŠ¨ä½¿ç”¨é¢„ç¼–è¯‘åŒ…ï¼Œä½†æŸäº›åŒ…å¯èƒ½éœ€è¦ç¼–è¯‘

3. **å‡çº§Railwayè®¡åˆ’**
   - ä»˜è´¹è®¡åˆ’æœ‰æ›´å¤šèµ„æº

---

### é”™è¯¯4: æ•°æ®åº“è¿žæŽ¥å¤±è´¥

**é”™è¯¯ä¿¡æ¯**:
```
password authentication failed
connection refused
```

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥çŽ¯å¢ƒå˜é‡**
   - ç¡®è®¤ `DATABASE_URL` å·²æ­£ç¡®é…ç½®
   - æ£€æŸ¥ç”¨æˆ·åæ ¼å¼ï¼ˆå¿…é¡»æ˜¯ `postgres.[PROJECT-REF]`ï¼‰

2. **éªŒè¯è¿žæŽ¥å­—ç¬¦ä¸²**
   ```bash
   # åœ¨æœ¬åœ°æµ‹è¯•
   python check_database.py
   ```

3. **æ£€æŸ¥Supabaseè®¾ç½®**
   - ç¡®è®¤æ•°æ®åº“å¯†ç æ­£ç¡®
   - æ£€æŸ¥IPç™½åå•ï¼ˆå¦‚æžœéœ€è¦ï¼‰

---

### é”™è¯¯5: åº”ç”¨å¯åŠ¨å¤±è´¥

**é”™è¯¯ä¿¡æ¯**:
```
ModuleNotFoundError: No module named 'xxx'
```

**è§£å†³æ–¹æ¡ˆ**:

1. **æ£€æŸ¥requirements.txt**
   - ç¡®è®¤æ‰€æœ‰ä¾èµ–éƒ½å·²åˆ—å‡º
   - æ£€æŸ¥æ˜¯å¦æœ‰æ‹¼å†™é”™è¯¯

2. **æŸ¥çœ‹Railwayæ—¥å¿—**
   - Railway â†’ Deployments â†’ View Logs
   - æŸ¥çœ‹å®Œæ•´çš„é”™è¯¯ä¿¡æ¯

3. **æœ¬åœ°æµ‹è¯•**
   ```bash
   # åœ¨æœ¬åœ°è™šæ‹ŸçŽ¯å¢ƒä¸­æµ‹è¯•
   python -m venv venv
   source venv/bin/activate  # Windows: venv\Scripts\activate
   pip install -r requirements.txt
   python app.py
   ```

---

### é”™è¯¯6: ç«¯å£é…ç½®é”™è¯¯

**é”™è¯¯ä¿¡æ¯**:
```
Address already in use
```

**è§£å†³æ–¹æ¡ˆ**:

1. **ä½¿ç”¨çŽ¯å¢ƒå˜é‡PORT**
   - Railwayä¼šè‡ªåŠ¨è®¾ç½® `$PORT` çŽ¯å¢ƒå˜é‡
   - ç¡®ä¿å¯åŠ¨å‘½ä»¤ä½¿ç”¨ `0.0.0.0:$PORT`

2. **æ£€æŸ¥Procfileæˆ–å¯åŠ¨å‘½ä»¤**
   ```bash
   # æ­£ç¡®
   gunicorn -w 4 -b 0.0.0.0:$PORT app:app
   
   # é”™è¯¯ï¼ˆç¡¬ç¼–ç ç«¯å£ï¼‰
   gunicorn -w 4 -b 0.0.0.0:5000 app:app
   ```

---

## ðŸ› ï¸ ä¼˜åŒ–å»ºè®®

### 1. å‡å°‘ä¾èµ–å¤§å°

å¦‚æžœä¸éœ€è¦æŸäº›åŠŸèƒ½ï¼Œå¯ä»¥æ³¨é‡ŠæŽ‰ç›¸å…³ä¾èµ–ï¼š

```txt
# å¦‚æžœä¸éœ€è¦embeddingåŠŸèƒ½
# sentence-transformers==2.2.2
# torch>=2.2.0,<3.0.0
# torchvision>=0.17.0,<1.0.0

# å¦‚æžœä¸éœ€è¦GUI
# tkinterdnd2==0.3.0
```

### 2. ä½¿ç”¨æ›´çµæ´»çš„ç‰ˆæœ¬çº¦æŸ

```txt
# æŽ¨èï¼šä½¿ç”¨ >= è€Œä¸æ˜¯ ==
flask>=3.0.0
flask-sqlalchemy>=3.1.0
Pillow>=10.0.0

# ä¸æŽ¨èï¼šå›ºå®šç‰ˆæœ¬
flask==3.0.0
```

### 3. åˆ›å»ºæœ€å°requirements.txt

åˆ›å»ºä¸€ä¸ª `requirements-minimal.txt` ç”¨äºŽéƒ¨ç½²ï¼š

```txt
# æ ¸å¿ƒä¾èµ–
flask>=3.0.0
flask-sqlalchemy>=3.1.1
psycopg2-binary>=2.9.9
python-dotenv>=1.0.0
gunicorn>=21.2.0
flask-cors>=4.0.0

# å¿…éœ€çš„å·¥å…·
Pillow>=10.0.0
requests>=2.31.0

# AIæœåŠ¡ï¼ˆå¿…éœ€ï¼‰
openai>=2.8.0

# Supabaseï¼ˆå¿…éœ€ï¼‰
supabase>=2.0.0

# å¯é€‰ï¼šå¦‚æžœéœ€è¦embeddingåŠŸèƒ½ï¼Œå–æ¶ˆæ³¨é‡Š
# sentence-transformers>=2.2.0
# torch>=2.2.0
# torchvision>=0.17.0
# numpy>=1.24.0
```

---

## ðŸ“‹ éƒ¨ç½²å‰æ£€æŸ¥æ¸…å•

- [ ] æ›´æ–° `requirements.txt` ä¸­çš„torchç‰ˆæœ¬
- [ ] æµ‹è¯•æœ¬åœ°å®‰è£…ï¼š`pip install -r requirements.txt`
- [ ] æ£€æŸ¥æ‰€æœ‰çŽ¯å¢ƒå˜é‡å·²é…ç½®
- [ ] ç¡®è®¤æ•°æ®åº“è¿žæŽ¥æ­£å¸¸
- [ ] æµ‹è¯•åº”ç”¨æœ¬åœ°å¯åŠ¨ï¼š`python app.py`
- [ ] æ£€æŸ¥å¯åŠ¨å‘½ä»¤ä½¿ç”¨ `$PORT` è€Œä¸æ˜¯å›ºå®šç«¯å£
- [ ] ç¡®è®¤ `.gitignore` æŽ’é™¤äº† `.env` æ–‡ä»¶

---

## ðŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹å®Œæ•´æ—¥å¿—

åœ¨Railwayä¸­ï¼š
1. è¿›å…¥é¡¹ç›® â†’ Deployments
2. ç‚¹å‡»å¤±è´¥çš„éƒ¨ç½²
3. æŸ¥çœ‹ "Build Logs" å’Œ "Deploy Logs"

### 2. æœ¬åœ°å¤çŽ°é—®é¢˜

```bash
# ä½¿ç”¨ä¸ŽRailwayç›¸åŒçš„Pythonç‰ˆæœ¬
python --version

# åˆ›å»ºå¹²å‡€çš„è™šæ‹ŸçŽ¯å¢ƒ
python -m venv venv
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# æµ‹è¯•å¯åŠ¨
python app.py
```

### 3. æ£€æŸ¥ä¾èµ–å†²çª

```bash
# æ£€æŸ¥å·²å®‰è£…çš„åŒ…
pip list

# æ£€æŸ¥ä¾èµ–æ ‘
pipdeptree

# æŸ¥æ‰¾å†²çª
pip check
```

---

## âœ… å·²ä¿®å¤çš„é—®é¢˜

### âœ… torchç‰ˆæœ¬é—®é¢˜ï¼ˆå·²ä¿®å¤ï¼‰

**é—®é¢˜**: `torch==2.1.0` ä¸å¯ç”¨

**ä¿®å¤**: æ›´æ–°ä¸º `torch>=2.2.0,<3.0.0`

**æ–‡ä»¶**: `requirements.txt`

---

## ðŸ†˜ ä»ç„¶é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æŸ¥çœ‹Railwayæ—¥å¿—**
   - å¤åˆ¶å®Œæ•´çš„é”™è¯¯ä¿¡æ¯
   - æ£€æŸ¥æ˜¯å“ªä¸€æ­¥å¤±è´¥

2. **æ£€æŸ¥Pythonç‰ˆæœ¬**
   - Railwayé»˜è®¤ä½¿ç”¨Python 3.12
   - æŸäº›åŒ…å¯èƒ½ä¸å…¼å®¹

3. **ç®€åŒ–ä¾èµ–**
   - ä¸´æ—¶æ³¨é‡ŠæŽ‰ä¸éœ€è¦çš„åŒ…
   - å…ˆç¡®ä¿æ ¸å¿ƒåŠŸèƒ½èƒ½éƒ¨ç½²

4. **è”ç³»æ”¯æŒ**
   - Railwayæ”¯æŒï¼šhttps://railway.app/help
   - æˆ–æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š`Supabaseéƒ¨ç½²æŒ‡å—.md`

---

**æç¤º**: å¦‚æžœtorchç›¸å…³åŒ…å¯¼è‡´é—®é¢˜ï¼Œä¸”ä½ ä¸éœ€è¦embeddingåŠŸèƒ½ï¼Œå¯ä»¥ä¸´æ—¶æ³¨é‡ŠæŽ‰è¿™äº›ä¾èµ–ï¼Œå…ˆè®©åº”ç”¨æˆåŠŸéƒ¨ç½²ã€‚
